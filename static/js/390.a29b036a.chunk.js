"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[390],{1390:(e,s,t)=>{t.d(s,{A:()=>z});var n=t(5043),r=t(3302),i=t(5287),a=t(6446),o=t(2557),l=t(1637),d=t(8911),c=t(2220),u=t(7832),h=t(5079),x=t(5865),m=t(3003),p=t(579);const g=e=>{let{avatar:s=[],name:t,_id:n,groupChat:r=!1,sameSender:i,isOnline:l,index:c=0,newMessageAlert:g}=e;const{theme:f}=(0,m.d4)((e=>e.chat));return(0,p.jsx)(u.N_,{sx:{padding:"0",borderRadius:"10px 10px 10px 0px"},to:"/chat/".concat(n),children:(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center",backgroundColor:i?o.wm:"unset",color:i?"black":"unset",position:"relative",padding:"1rem"},children:[(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)(h.A,{avatar:s}),l&&!r&&(0,p.jsx)(a.A,{sx:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"green",border:"0.5px solid white",margin:"2px",marginBottom:0,position:"absolute",bottom:0,right:{xs:"1.7rem",sm:"1rem"},transform:"translateY(-50%)"}})]}),(0,p.jsx)(d.A,{children:(0,p.jsx)(x.A,{variant:"h6",children:t})}),(0,p.jsx)(x.A,{sx:{fontSize:"0.75rem",padding:"0px 7px",margin:"3px",bgcolor:f,color:o.ON,borderRadius:"50%",position:"absolute",right:0},children:null===g||void 0===g?void 0:g.count})]})})},f=(0,n.memo)(g);var j=t(3216),v=t(9648),A=t(4149),b=t(3355),w=t(7038),C=t(3845);const k=e=>{let{optionType:s,setOptionType:t}=e;const{theme:n}=(0,m.d4)((e=>e.chat));return(0,p.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,margin:"0.5rem",marginTop:0,padding:"0.5rem",borderRadius:"1rem",children:[(0,p.jsx)(C.A,{label:"All",variant:"all"===s?"filled":"outlined",clickable:!0,onClick:()=>t("all"),sx:{bgcolor:"all"===s?n:"transparent",color:"all"===s?"#ffffff":n,borderColor:"all"!==s&&n}}),(0,p.jsx)(C.A,{label:"Unread",variant:"unread"===s?"filled":"outlined",clickable:!0,onClick:()=>t("unread"),sx:{bgcolor:"unread"===s?n:"transparent",color:"unread"===s?"#ffffff":n,borderColor:"unread"!==s&&n}}),(0,p.jsx)(C.A,{label:"Groups",variant:"groups"===s?"filled":"outlined",clickable:!0,onClick:()=>t("groups"),sx:{bgcolor:"groups"===s?n:"transparent",color:"groups"===s?"#ffffff":n,borderColor:"groups"!==s&&n}})]})},y=(0,n.memo)(k),E=(0,n.lazy)((()=>Promise.all([t.e(122),t.e(178),t.e(219),t.e(615)]).then(t.bind(t,615)))),S=e=>{var s;let{chats:t=[],newMessagesAlert:r=[{chatId:"",count:0}],user:i,onlineUsers:h=[],isLoading:g}=e;const C=(0,m.wA)(),k=(0,j.g)(),S=null===k||void 0===k?void 0:k.id,_=(0,n.useRef)(null),[T,I]=(0,n.useState)(""),[O,R]=(0,n.useState)(t),[N,M]=(0,n.useState)(!1),[P,L]=(0,n.useState)("all"),{isProfile:D}=(0,m.d4)((e=>e.misc)),{theme:U}=(0,m.d4)((e=>e.chat)),G=()=>{switch(P){case"unread":const e=null===t||void 0===t?void 0:t.filter((e=>r.some((s=>s.chatId===e._id))));R(e);break;case"groups":const s=null===t||void 0===t?void 0:t.filter((e=>!0===(null===e||void 0===e?void 0:e.groupChat)));R(s);break;default:R(t)}};(0,n.useEffect)((()=>{R(t)}),[t]),(0,n.useEffect)((()=>{if(""===T.trim())G();else{const e=O.filter((e=>e.name.toLowerCase().includes(T.toLowerCase().trim())));R(e)}}),[T]),(0,n.useEffect)((()=>{G()}),[P]);const z=e=>{M(!0),_.current=e.currentTarget};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(a.A,{sx:{display:{xs:S?"none":"flex",sm:"flex"},flexDirection:"column",borderBottom:"1px solid black",width:{xs:"100%",sm:"30%"},height:"100vh"},children:[(0,p.jsx)(w.A,{isOpen:N,setIsOpen:M,dispatch:C,menuAnchor:_,openProfile:()=>{M(!1),C((0,b.QD)(!0))}}),(0,p.jsxs)(a.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"space-around",alignItems:"center",backgroundColor:o.ON,borderRadius:"15px",padding:"5px",position:"sticky",top:0,height:{xs:"20%",sm:"15%",md:"auto"}},margin:"5px",children:[(0,p.jsxs)(a.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:{xs:"100%",sm:"auto"}},children:[(0,p.jsx)(x.A,{variant:"h5",sx:{marginLeft:"5px"},children:"Chats"}),null!==i&&void 0!==i&&null!==(s=i.avatar)&&void 0!==s&&s.url?(0,p.jsx)(v.A,{title:null===i||void 0===i?void 0:i.username,src:i.avatar.url,color:D?U:"inherit",sx:{display:{xs:"flex",sm:"none"}},onClick:z}):(0,p.jsx)(v.A,{title:null===i||void 0===i?void 0:i.username,icon:(0,p.jsx)(A.A,{}),color:D?U:"inherit",sx:{display:{xs:"flex",sm:"none"}},onClick:z})]}),(0,p.jsx)(u.cl,{placeholder:"Search Friends...",value:T,onChange:e=>{I(e.target.value)}})]}),g?(0,p.jsx)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsx)(l.A,{sx:{color:U}})}):(0,p.jsxs)(d.A,{direction:"column",sx:{height:"100%",overflow:"auto",backgroundColor:o.ON,borderRadius:"20px",marginRight:"5px",border:"2px solid ".concat(o.ON),position:"sticky",top:0},children:[(0,p.jsx)(y,{optionType:P,setOptionType:L}),!g&&(null===O||void 0===O?void 0:O.length)>0?null===O||void 0===O?void 0:O.map(((e,s)=>{const{avatar:t,_id:n,name:i,groupChat:a,members:o}=e,l=r.find((e=>{let{chatId:s}=e;return s===n})),d=null===o||void 0===o?void 0:o.some((e=>h.includes(e)));return(0,p.jsx)(f,{index:s,newMessageAlert:l,isOnline:d,avatar:t,name:i,_id:n,groupChat:a,sameSender:S===n},n)})):(0,p.jsx)(x.A,{textAlign:"center",padding:"1rem",children:"No chats"})]})]}),D&&(0,p.jsx)(n.Suspense,{fallback:(0,p.jsx)(c.A,{open:!0}),children:(0,p.jsx)(E,{})})]})},_=(0,n.memo)(S),T=[{attachments:[{public_id:"asdsad",url:"https://www.w3schools.com/howto/img_avatar.png"}],content:"Test Message",_id:"dkaldaljdljldkalajlkjfafaadf",sender:{_id:"user._id",name:"Test"},chat:"1",createdAt:"2024-02-12T10:41:30.360Z",sameSender:!0},{attachments:[{public_id:"asdsad",url:"https://www.w3schools.com/howto/img_avatar.png"}],content:"Test Message 2",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"2",sameSender:!1,createdAt:"2024-04-24T10:41:30.360Z"},{content:"Hey there!",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"2",createdAt:"2024-04-24T10:41:30.360Z",sameSender:!1},{content:"I am using Your app",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"1",sameSender:!0,createdAt:"2024-04-24T10:41:30.360Z"},{content:"Testing frontend",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"1",createdAt:"2024-04-24T10:41:30.360Z",sameSender:!0}];var I=t(3202),O=t(4852),R=t(5948),N=t(7025),M=t(2581),P=t(141),L=t(2437),D=t(3010),U=t(6625);const G=e=>{let{dispatch:s,deleteMenuAnchor:t}=e;const{isDeleteMenu:r,selectedDeleteChat:i}=(0,m.d4)((e=>e.misc)),a=(0,j.Zp)(),o=()=>{s((0,b.Tw)(!1)),t.current=null},l=null===i||void 0===i?void 0:i.groupChat,[c,,u]=(0,R.dF)(I.wU),[h,,g]=(0,R.dF)(I.bZ);return(0,n.useEffect)((()=>{(u||g)&&a("/")}),[u,g]),(0,p.jsx)(L.A,{open:r,onClose:o,anchorEl:t.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"center"},children:(0,p.jsx)(d.A,{sx:{width:"10rem",padding:"0.5rem",cursor:"pointer"},direction:"row",alignItems:"center",spacing:"0.5rem",onClick:l?()=>{o(),h("Leaving Group...",null===i||void 0===i?void 0:i.chatId)}:()=>{o(),c("Deleting Chat...",null===i||void 0===i?void 0:i.chatId)},children:l?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(D.A,{})," ",(0,p.jsx)(x.A,{children:"Leave Group"})]}):(0,p.jsxs)(p.Fragment,{children:[" ",(0,p.jsx)(U.A,{})," ",(0,p.jsx)(x.A,{children:"Clear Chat"})]})})})},z=()=>e=>s=>{const{user:t}=(0,m.d4)((e=>e.auth)),{newMessageAlert:l,newMessagesCount:d}=(0,m.d4)((e=>e.chat)),[c,u]=(0,n.useState)([]),h=(0,j.g)(),x=(0,O.Y)(),g=(0,m.wA)(),f=(0,j.Zp)(),v=h.id,A=(0,n.useRef)(null),{data:w,isLoading:C,refetch:k}=(0,I.X2)("");(0,n.useEffect)((()=>{(0,P.a2)({key:N.qS,value:l}),g((0,M.v9)())}),[l,g]),(0,n.useEffect)((()=>{k(),x.emit(N.Jw,{userId:t._id})}),[null===t||void 0===t?void 0:t.user,k,x,t._id]),(0,n.useEffect)((()=>(x.emit(N.nW,{userId:null===t||void 0===t?void 0:t._id}),()=>x.emit(N.EI,{userId:t._id}))),[]);const y=(0,n.useCallback)((e=>{e.chatId!==v&&g((0,M.X6)(e))}),[v,g]),E=(0,n.useCallback)((e=>{u(e)}),[v]),S=(0,n.useCallback)((()=>{g((0,M.z5)())}),[g]),L=(0,n.useCallback)((e=>{k(),f("/")}),[k,f]),D={[N.qS]:y,[N.nF]:E,[N.bU]:S,[N.u_]:L};return(0,R.Q7)(x,D),(0,p.jsxs)(a.A,{sx:{display:"flex",position:{xs:"relative",sm:"fixed"},flexDirection:{xs:"column-reverse",sm:"row"},backgroundColor:o.wm,height:"100%",width:"100%"},children:[(0,p.jsx)(r.A,{newMessagesCount:d}),(0,p.jsx)(i.A,{chatId:v}),(0,p.jsx)(G,{dispatch:g,deleteMenuAnchor:A}),(0,p.jsx)(_,{chats:null===w||void 0===w?void 0:w.chats,newMessagesAlert:l,onlineUsers:c,user:t,isLoading:C}),(0,p.jsx)(e,{...s,chatId:v,user:t,chats:T,handleDeleteChat:(e,s,t)=>{g((0,b.Tw)(!0)),g((0,b.DI)({chatId:s,groupChat:t})),A.current=e.currentTarget}})]})}},9648:(e,s,t)=>{t.d(s,{A:()=>h});var n=t(5043),r=t(2167),i=t(7392),a=t(8780),o=t(9379),l=t(5865),d=t(3003),c=t(579);const u=e=>{let{title:s,icon:t,onClick:n,value:u,color:h="inherit",sx:x,src:m,name:p}=e;const{theme:g}=(0,d.d4)((e=>e.chat));return(0,c.jsx)(r.A,{title:s,sx:x,children:(0,c.jsxs)(i.A,{size:"large",onClick:n,style:{color:h,flexDirection:"column"},children:[m?u?(0,c.jsx)(a.A,{badgeContent:u,sx:{"& .MuiBadge-badge":{backgroundColor:"inherit"===h?"white":h,color:"inherit"===h?"black":"white"}},children:t}):(0,c.jsx)(o.A,{src:m}):u?(0,c.jsx)(a.A,{badgeContent:u,sx:{"& .MuiBadge-badge":{backgroundColor:"inherit"===h?g:"white",color:"inherit"===h?"white":"black"}},children:t}):t,p&&(0,c.jsx)(l.A,{sx:{fontSize:"0.6rem",display:{xs:"flex",sm:"none"}},children:p})]})})},h=(0,n.memo)(u)},5287:(e,s,t)=>{t.d(s,{A:()=>_});var n=t(2314),r=t(5865),i=t(6446),a=t(2220),o=t(5043),l=t(2557),d=t(9484),c=t(2522),u=t(7241),h=t(5626),x=t(4149),m=t(6598),p=t(8923),g=t(9648),f=t(3216),j=t(3003),v=t(3355),A=t(2581),b=t(7038),w=t(579);const C=(0,o.lazy)((()=>Promise.all([t.e(122),t.e(322),t.e(981)]).then(t.bind(t,2981)))),k=(0,o.lazy)((()=>Promise.all([t.e(322),t.e(621)]).then(t.bind(t,1621)))),y=(0,o.lazy)((()=>Promise.all([t.e(122),t.e(322),t.e(307)]).then(t.bind(t,8307)))),E=(0,o.lazy)((()=>Promise.all([t.e(122),t.e(178),t.e(219),t.e(615)]).then(t.bind(t,615)))),S=e=>{var s;let{chatId:t}=e;const S=(0,f.Zp)(),_=(0,f.zy)(),T=(0,j.wA)(),[I,O]=(0,o.useState)(!1),R=(0,o.useRef)(null),{user:N}=(0,j.d4)((e=>e.auth)),{isSearch:M,isNotification:P,isNewGroup:L,isProfile:D}=(0,j.d4)((e=>e.misc)),{notificationCount:U,theme:G,newMessagesCount:z}=(0,j.d4)((e=>e.chat)),F=e=>{O(!0),R.current=e.currentTarget};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(n.A,{sx:{bgcolor:l.Zp,height:{xs:"auto",sm:"100vh"},width:{xs:"100vw",sm:"80px"},margin:{xs:"none",sm:"3px"},padding:{xs:"none",sm:"10px"},borderRadius:{xs:"10px 10px 0px 0px",sm:"20px"},display:{xs:t?"none":"flex",sm:"flex"},flexDirection:{xs:"row",sm:"column"},alignItems:{xs:"center",sm:"space-between"},justifyContent:{xs:"center",sm:"space-around"},position:{sm:"sticky",xs:"fixed"},left:{sm:0,xs:0},right:{sm:"auto",xs:"auto"},bottom:{sm:"auto",xs:0},top:{sm:0,xs:"auto"}},children:[(0,w.jsx)(b.A,{isOpen:I,setIsOpen:O,dispatch:T,menuAnchor:R,openProfile:()=>{O(!1),T((0,v.QD)(!0))}}),(0,w.jsx)(r.A,{variant:"h6",sx:{display:{xs:"none",sm:"block"}},children:(0,w.jsx)(p.A,{})}),(0,w.jsxs)(i.A,{children:[(0,w.jsx)(g.A,{title:"Chats",icon:(0,w.jsx)(m.A,{}),onClick:()=>{S("/")},color:!_.pathname.includes("/chat")&&"/"!==_.pathname||M||P||L||D?"inherit":G,value:z}),(0,w.jsx)(g.A,{title:"Search",icon:(0,w.jsx)(d.A,{}),color:M?G:"inherit",onClick:()=>T((0,v.Dm)(!0))}),(0,w.jsx)(g.A,{title:"New Group",icon:(0,w.jsx)(c.A,{}),color:L?G:"inherit",onClick:()=>T((0,v.uX)(!0))}),(0,w.jsx)(g.A,{title:"Manage Groups",icon:(0,w.jsx)(u.A,{}),color:_.pathname.includes("/groups")?G:"inherit",onClick:()=>{S("/groups")}}),(0,w.jsx)(g.A,{title:"Notifications",icon:(0,w.jsx)(h.A,{}),color:P?G:"inherit",value:U,onClick:()=>{T((0,v.kT)(!0)),T((0,A.Gd)())}})]}),null!==N&&void 0!==N&&null!==(s=N.avatar)&&void 0!==s&&s.url?(0,w.jsx)(g.A,{title:N.username,src:N.avatar.url,color:D?G:"inherit",sx:{display:{xs:"none",sm:"flex"}},onClick:F}):(0,w.jsx)(g.A,{title:N.username,icon:(0,w.jsx)(x.A,{}),color:D?G:"inherit",sx:{display:{xs:"none",sm:"flex"}},onClick:F})]}),M&&(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(C,{})}),P&&(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(k,{})}),L&&(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(y,{})}),D&&(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(E,{})})]})},_=(0,o.memo)(S)},7025:(e,s,t)=>{t.d(s,{$H:()=>d,EI:()=>x,J8:()=>n,Jw:()=>c,OR:()=>g,_b:()=>p,bU:()=>a,hV:()=>f,nF:()=>u,nW:()=>h,o9:()=>m,qS:()=>i,tq:()=>o,u_:()=>r,v_:()=>l});const n="ALERT",r="REFETCH_CHATS",i="NEW_MESSAGE_ALERT",a="NEW_REQUEST",o="NEW_MESSAGE",l="START_TYPING",d="STOP_TYPING",c="CHAT_JOINED",u="ONLINE_USERS",h="ONLINE_USER_SET",x="ONLINE_USER_DELETE",m="GROUP_USER_TYPING",p="GROUP_USER_STOPPED_TYPING",g="REFETCH_PROFILE",f="REFETCH_GROUP_CHAT_MEMBERS"},7038:(e,s,t)=>{t.d(s,{A:()=>p});var n=t(2437),r=t(922),i=t(6990),a=t(8734),o=t(5043),l=t(3552),d=t(1702),c=t(8925),u=t(3768),h=t(6213),x=t(579);const m=e=>{let{isOpen:s,setIsOpen:t,dispatch:o,menuAnchor:m,openProfile:p}=e;return(0,x.jsx)(n.A,{open:s,onClose:()=>{m.current=null,t(!1)},anchorEl:m.current,anchorOrigin:{vertical:"right",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"center"},children:(0,x.jsx)("div",{style:{width:"10rem"},children:(0,x.jsxs)(r.A,{children:[(0,x.jsxs)(i.A,{onClick:p,children:[(0,x.jsx)(l.A,{}),(0,x.jsx)(a.A,{style:{marginLeft:"0.5rem"},children:"MyProfile"})]}),(0,x.jsxs)(i.A,{onClick:async()=>{try{const{data:e}=await h.A.get("".concat("https://chat-app-mern-07dn.onrender.com","/api/v1/user/logout"),{withCredentials:!0});o((0,c.TW)()),u.Ay.success(e.message)}catch(n){var e,s;u.Ay.error((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Something went wrong")}t(!1)},children:[(0,x.jsx)(d.A,{}),(0,x.jsx)(a.A,{style:{marginLeft:"0.5rem"},children:"Logout"})]})]})})})},p=(0,o.memo)(m)},5948:(e,s,t)=>{t.d(s,{Q7:()=>i,dF:()=>o,xB:()=>a});var n=t(5043),r=t(3768);const i=(e,s)=>{(0,n.useEffect)((()=>(Object.entries(s).forEach((s=>{let[t,n]=s;e.on(t,n)})),()=>{Object.entries(s).forEach((s=>{let[t,n]=s;e.off(t,n)}))})),[e,s])},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,n.useEffect)((()=>{e.forEach((e=>{let{isError:s,error:t,fallBack:n}=e;var i;s&&(n?n():r.Ay.error((null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message)||"Something went wrong"))}))}),[e])},o=e=>{const[s,t]=(0,n.useState)(!1),[i,a]=(0,n.useState)(null),[o]=e();return[async function(e){t(!0);const s=r.Ay.loading(e||"Updating data...");try{for(var n=arguments.length,i=new Array(n>1?n-1:0),l=1;l<n;l++)i[l-1]=arguments[l];const e=await o(...i);var d,c;if(e.data)r.Ay.success(e.data.message||"Updated data Successfuly",{id:s}),a(e.data);else r.Ay.error((null===e||void 0===e||null===(d=e.error)||void 0===d||null===(c=d.data)||void 0===c?void 0:c.message)||"Something went wrong",{id:s})}catch(u){console.log(u),r.Ay.error("Something went wrong!",{id:s})}finally{t(!1)}},s,i]}},5079:(e,s,t)=>{t.d(s,{A:()=>c});var n=t(5043),r=t(8911),i=t(5754),a=t(6446),o=t(9379),l=t(579);const d=e=>{let{avatar:s=[],max:t=4}=e;return(0,l.jsx)(r.A,{direction:"row",spacing:.5,children:(0,l.jsxs)(i.A,{max:t,sx:{position:"relative"},children:[(0,l.jsx)(a.A,{width:"5rem",height:"3rem"}),s&&(null===s||void 0===s?void 0:s.map(((e,s)=>{var t;return(0,l.jsx)(o.A,{src:null!==e&&void 0!==e&&e.avatar?null===e||void 0===e||null===(t=e.avatar)||void 0===t?void 0:t.url:e,alt:"Avatar ".concat(s),sx:{width:"3rem",height:"3rem",position:"absolute",left:{xs:"".concat(.5+s,"rem"),sm:"".concat(s+1,"rem")}}},100*Math.random())})))]})})},c=(0,n.memo)(d)},3302:(e,s,t)=>{t.d(s,{A:()=>o});var n=t(5043),r=t(9367),i=t(579);const a=e=>{let{title:s="We-Chat",description:t="This is the Chat App",newMessagesCount:n=0}=e;return(0,i.jsxs)(r.mg,{children:[n>0?(0,i.jsx)("title",{children:"(".concat(n,") ")+s}):(0,i.jsx)("title",{children:s}),(0,i.jsx)("meta",{name:"description",content:t})]})},o=(0,n.memo)(a)}}]);
//# sourceMappingURL=390.a29b036a.chunk.js.map