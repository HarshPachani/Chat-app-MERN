"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[390],{1390:(e,t,s)=>{s.d(t,{A:()=>L});var n=s(5043),r=s(3302),i=s(5287),a=s(6446),l=s(2557),o=s(8911),d=s(2220),c=s(7832),u=s(5079),h=s(5865),x=s(3003),m=s(579);const p=e=>{let{avatar:t=[],name:s,_id:n,groupChat:r=!1,sameSender:i,isOnline:d,index:p=0,newMessageAlert:g}=e;const{theme:f}=(0,x.d4)((e=>e.chat));return(0,m.jsx)(c.N_,{sx:{padding:"0",borderRadius:"10px 10px 10px 0px"},to:"/chat/".concat(n),children:(0,m.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center",backgroundColor:i?l.wm:"unset",color:i?"black":"unset",position:"relative",padding:"1rem"},children:[(0,m.jsxs)("div",{style:{position:"relative"},children:[(0,m.jsx)(u.A,{avatar:t}),d&&!r&&(0,m.jsx)(a.A,{sx:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"green",border:"0.5px solid white",margin:"2px",marginBottom:0,position:"absolute",bottom:0,right:{xs:"1.7rem",sm:"1rem"},transform:"translateY(-50%)"}})]}),(0,m.jsx)(o.A,{children:(0,m.jsx)(h.A,{variant:"h6",children:s})}),(0,m.jsx)(h.A,{sx:{fontSize:"0.75rem",padding:"0px 7px",margin:"3px",bgcolor:f,color:l.ON,borderRadius:"50%",position:"absolute",right:0},children:null===g||void 0===g?void 0:g.count})]})})},g=(0,n.memo)(p);var f=s(3216),j=s(9648),v=s(4149),A=s(3355),b=s(7038),w=s(3845);const k=e=>{let{optionType:t,setOptionType:s}=e;const{theme:n}=(0,x.d4)((e=>e.chat));return(0,m.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,margin:"0.5rem",marginTop:0,padding:"0.5rem",borderRadius:"1rem",children:[(0,m.jsx)(w.A,{label:"All",variant:"all"===t?"filled":"outlined",clickable:!0,onClick:()=>s("all"),sx:{bgcolor:"all"===t?n:"transparent",color:"all"===t?"#ffffff":n,borderColor:"all"!==t&&n}}),(0,m.jsx)(w.A,{label:"Unread",variant:"unread"===t?"filled":"outlined",clickable:!0,onClick:()=>s("unread"),sx:{bgcolor:"unread"===t?n:"transparent",color:"unread"===t?"#ffffff":n,borderColor:"unread"!==t&&n}}),(0,m.jsx)(w.A,{label:"Group",variant:"group"===t?"filled":"outlined",clickable:!0,onClick:()=>s("group"),sx:{bgcolor:"group"===t?n:"transparent",color:"group"===t?"#ffffff":n,borderColor:"group"!==t&&n}})]})},C=(0,n.memo)(k),y=(0,n.lazy)((()=>Promise.all([s.e(122),s.e(178),s.e(219),s.e(315)]).then(s.bind(s,315)))),E=e=>{var t;let{w:s="30%",chats:r=[],newMessagesAlert:i=[{chatId:"",count:0}],user:u,onlineUsers:p=[]}=e;const w=(0,x.wA)(),k=(0,f.g)(),E=null===k||void 0===k?void 0:k.id,_=(0,n.useRef)(null),[S,T]=(0,n.useState)(""),[I,O]=(0,n.useState)(r),[R,N]=(0,n.useState)(!1),[P,M]=(0,n.useState)("all"),{isProfile:U}=(0,x.d4)((e=>e.misc)),{theme:D}=(0,x.d4)((e=>e.chat)),G=()=>{switch(P){case"unread":const e=null===r||void 0===r?void 0:r.filter((e=>i.some((t=>t.chatId===e._id))));O(e);break;case"group":const t=null===r||void 0===r?void 0:r.filter((e=>!0===(null===e||void 0===e?void 0:e.groupChat)));O(t);break;default:O(r)}};(0,n.useEffect)((()=>{O(r)}),[r]),(0,n.useEffect)((()=>{if(""===S.trim())G();else{const e=I.filter((e=>e.name.toLowerCase().includes(S.toLowerCase().trim())));O(e)}}),[S]),(0,n.useEffect)((()=>{G()}),[P]);const L=e=>{N(!0),_.current=e.currentTarget};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.A,{sx:{display:{xs:E?"none":"flex",sm:"flex"},flexDirection:"column",borderBottom:"1px solid black",width:{xs:"100%",sm:"30%"},height:"100vh"},children:[(0,m.jsx)(b.A,{isOpen:R,setIsOpen:N,dispatch:w,menuAnchor:_,openProfile:()=>{N(!1),w((0,A.QD)(!0))}}),(0,m.jsxs)(a.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"space-around",alignItems:"center",backgroundColor:l.ON,borderRadius:"15px",padding:"5px",position:"sticky",top:0,height:"auto"},margin:"5px",children:[(0,m.jsxs)(a.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:{xs:"100%",sm:"auto"}},children:[(0,m.jsx)(h.A,{variant:"h5",sx:{marginLeft:"5px"},children:"Chats"}),null!==u&&void 0!==u&&null!==(t=u.avatar)&&void 0!==t&&t.url?(0,m.jsx)(j.A,{title:null===u||void 0===u?void 0:u.username,src:u.avatar.url,color:U?D:"inherit",sx:{display:{xs:"flex",sm:"none"}},onClick:L}):(0,m.jsx)(j.A,{title:null===u||void 0===u?void 0:u.username,icon:(0,m.jsx)(v.A,{}),color:U?D:"inherit",sx:{display:{xs:"flex",sm:"none"}},onClick:L})]}),(0,m.jsx)(c.cl,{placeholder:"Search Friends...",value:S,onChange:e=>{T(e.target.value)}})]}),(0,m.jsxs)(o.A,{direction:"column",sx:{height:"100%",overflow:"auto",backgroundColor:l.ON,borderRadius:"20px",marginRight:"5px",border:"2px solid ".concat(l.ON),position:"sticky",top:0},children:[(0,m.jsx)(C,{optionType:P,setOptionType:M}),(null===I||void 0===I?void 0:I.length)>0?null===I||void 0===I?void 0:I.map(((e,t)=>{const{avatar:s,_id:n,name:r,groupChat:a,members:l}=e,o=i.find((e=>{let{chatId:t}=e;return t===n})),d=null===l||void 0===l?void 0:l.some((e=>p.includes(e)));return(0,m.jsx)(g,{index:t,newMessageAlert:o,isOnline:d,avatar:s,name:r,_id:n,groupChat:a,sameSender:E===n},n)})):(0,m.jsx)(h.A,{textAlign:"center",padding:"1rem",children:"No chats"})]})]}),U&&(0,m.jsx)(n.Suspense,{fallback:(0,m.jsx)(d.A,{open:!0}),children:(0,m.jsx)(y,{})})]})},_=(0,n.memo)(E),S=[{attachments:[{public_id:"asdsad",url:"https://www.w3schools.com/howto/img_avatar.png"}],content:"Test Message",_id:"dkaldaljdljldkalajlkjfafaadf",sender:{_id:"user._id",name:"Test"},chat:"1",createdAt:"2024-02-12T10:41:30.360Z",sameSender:!0},{attachments:[{public_id:"asdsad",url:"https://www.w3schools.com/howto/img_avatar.png"}],content:"Test Message 2",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"2",sameSender:!1,createdAt:"2024-04-24T10:41:30.360Z"},{content:"Hey there!",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"2",createdAt:"2024-04-24T10:41:30.360Z",sameSender:!1},{content:"I am using Your app",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"1",sameSender:!0,createdAt:"2024-04-24T10:41:30.360Z"},{content:"Testing frontend",_id:"dkaldaljdljldkalajlkjf",sender:{_id:"sdfsdfsdf",name:"Test2"},chat:"1",createdAt:"2024-04-24T10:41:30.360Z",sameSender:!0}];var T=s(3202),I=s(4852),O=s(5948),R=s(7025),N=s(2581),P=s(141),M=s(2437),U=s(3010),D=s(6625);const G=e=>{let{dispatch:t,deleteMenuAnchor:s}=e;const{isDeleteMenu:r,selectedDeleteChat:i}=(0,x.d4)((e=>e.misc)),a=(0,f.Zp)(),l=()=>{t((0,A.Tw)(!1)),s.current=null},d=null===i||void 0===i?void 0:i.groupChat,[c,,u]=(0,O.dF)(T.wU),[p,,g]=(0,O.dF)(T.bZ);return(0,n.useEffect)((()=>{(u||g)&&a("/")}),[u,g]),(0,m.jsx)(M.A,{open:r,onClose:l,anchorEl:s.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"center"},children:(0,m.jsx)(o.A,{sx:{width:"10rem",padding:"0.5rem",cursor:"pointer"},direction:"row",alignItems:"center",spacing:"0.5rem",onClick:d?()=>{l(),p("Leaving Group...",null===i||void 0===i?void 0:i.chatId)}:()=>{l(),c("Deleting Chat...",null===i||void 0===i?void 0:i.chatId)},children:d?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(U.A,{})," ",(0,m.jsx)(h.A,{children:"Leave Group"})]}):(0,m.jsxs)(m.Fragment,{children:[" ",(0,m.jsx)(D.A,{})," ",(0,m.jsx)(h.A,{children:"Clear Chat"})]})})})},L=()=>e=>t=>{const{user:s}=(0,x.d4)((e=>e.auth)),{newMessageAlert:o}=(0,x.d4)((e=>e.chat)),[d,c]=(0,n.useState)([]),u=(0,f.g)(),h=(0,I.Y)(),p=(0,x.wA)(),g=(0,f.Zp)(),j=u.id,v=(0,n.useRef)(null),{data:b,refetch:w}=(0,T.X2)("");(0,n.useEffect)((()=>{(0,P.a2)({key:R.qS,value:o}),p((0,N.v9)())}),[o,p]),(0,n.useEffect)((()=>{w(),h.emit(R.Jw,{userId:s._id})}),[null===s||void 0===s?void 0:s.user,w,h,s._id]),(0,n.useEffect)((()=>(h.emit(R.nW,{userId:null===s||void 0===s?void 0:s._id}),()=>h.emit(R.EI,{userId:s._id}))),[]);const k=(0,n.useCallback)((e=>{e.chatId!==j&&p((0,N.X6)(e))}),[j,p]),C=(0,n.useCallback)((e=>{c(e)}),[j]),y=(0,n.useCallback)((()=>{p((0,N.z5)())}),[p]),E=(0,n.useCallback)((e=>{w(),g("/")}),[w,g]),M={[R.qS]:k,[R.nF]:C,[R.bU]:y,[R.u_]:E};return(0,O.Q7)(h,M),(0,m.jsxs)(a.A,{sx:{display:"flex",position:{xs:"relative",sm:"fixed"},flexDirection:{xs:"column-reverse",sm:"row"},backgroundColor:l.wm,height:"100%",width:"100%"},children:[(0,m.jsx)(r.A,{}),(0,m.jsx)(i.A,{chatId:j}),(0,m.jsx)(G,{dispatch:p,deleteMenuAnchor:v}),(0,m.jsx)(_,{chats:null===b||void 0===b?void 0:b.chats,newMessagesAlert:o,onlineUsers:d,user:s}),(0,m.jsx)(e,{...t,chatId:j,user:s,chats:S,handleDeleteChat:(e,t,s)=>{p((0,A.Tw)(!0)),p((0,A.DI)({chatId:t,groupChat:s})),v.current=e.currentTarget}})]})}},9648:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(5043),r=s(2167),i=s(7392),a=s(8780),l=s(9379),o=s(579);const d=e=>{let{title:t,icon:s,onClick:n,value:d,color:c="inherit",sx:u,src:h}=e;return(0,o.jsx)(r.A,{title:t,sx:u,children:(0,o.jsx)(i.A,{size:"large",onClick:n,style:{color:c},children:h?d?(0,o.jsx)(a.A,{badgeContent:d,sx:{"& .MuiBadge-badge":{backgroundColor:"inherit"===c?"white":c,color:"inherit"===c?"black":"white"}},children:s}):(0,o.jsx)(l.A,{src:h}):d?(0,o.jsx)(a.A,{badgeContent:d,sx:{"& .MuiBadge-badge":{backgroundColor:"inherit"===c?"white":c,color:"inherit"===c?"black":"white"}},children:s}):s})})},c=(0,n.memo)(d)},5287:(e,t,s)=>{s.d(t,{A:()=>S});var n=s(2314),r=s(5865),i=s(6446),a=s(2220),l=s(5043),o=s(2557),d=s(9484),c=s(2522),u=s(7241),h=s(5626),x=s(4149),m=s(6598),p=s(8923),g=s(9648),f=s(3216),j=s(3003),v=s(3355),A=s(2581),b=s(7038),w=s(579);const k=(0,l.lazy)((()=>Promise.all([s.e(122),s.e(322),s.e(981)]).then(s.bind(s,2981)))),C=(0,l.lazy)((()=>Promise.all([s.e(322),s.e(621)]).then(s.bind(s,1621)))),y=(0,l.lazy)((()=>Promise.all([s.e(122),s.e(322),s.e(307)]).then(s.bind(s,8307)))),E=(0,l.lazy)((()=>Promise.all([s.e(122),s.e(178),s.e(219),s.e(315)]).then(s.bind(s,315)))),_=e=>{var t;let{chatId:s}=e;const _=(0,f.Zp)(),S=(0,f.zy)(),T=(0,j.wA)(),[I,O]=(0,l.useState)(!1),R=(0,l.useRef)(null),{user:N}=(0,j.d4)((e=>e.auth)),{isSearch:P,isNotification:M,isNewGroup:U,isProfile:D}=(0,j.d4)((e=>e.misc)),{notificationCount:G,theme:L,newMessagesCount:F}=(0,j.d4)((e=>e.chat)),z=e=>{O(!0),R.current=e.currentTarget};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(n.A,{sx:{bgcolor:o.Zp,height:{xs:"40px",sm:"100vh"},width:{xs:"100vw",sm:"80px"},margin:{xs:"none",sm:"3px"},padding:{xs:"none",sm:"10px"},borderRadius:"20px",display:{xs:s?"none":"flex",sm:"flex"},flexDirection:{xs:"row",sm:"column"},alignItems:{xs:"center",sm:"space-between"},justifyContent:{xs:"center",sm:"space-around"},position:{sm:"sticky",xs:"fixed"},left:{sm:0,xs:0},right:{sm:"auto",xs:"auto"},bottom:{sm:"auto",xs:0},top:{sm:0,xs:"auto"}},children:[(0,w.jsx)(b.A,{isOpen:I,setIsOpen:O,dispatch:T,menuAnchor:R,openProfile:()=>{O(!1),T((0,v.QD)(!0))}}),(0,w.jsx)(r.A,{variant:"h6",sx:{display:{xs:"none",sm:"block"}},children:(0,w.jsx)(p.A,{})}),(0,w.jsxs)(i.A,{children:[(0,w.jsx)(g.A,{title:"Chats",icon:(0,w.jsx)(m.A,{}),onClick:()=>{_("/")},color:!S.pathname.includes("/chat")&&"/"!==S.pathname||P||M||U||D?"inherit":L,value:F}),(0,w.jsx)(g.A,{title:"Search",icon:(0,w.jsx)(d.A,{}),color:P?L:"inherit",onClick:()=>T((0,v.Dm)(!0))}),(0,w.jsx)(g.A,{title:"New Group",icon:(0,w.jsx)(c.A,{}),color:U?L:"inherit",onClick:()=>T((0,v.uX)(!0))}),(0,w.jsx)(g.A,{title:"Manage Groups",icon:(0,w.jsx)(u.A,{}),color:S.pathname.includes("/groups")?L:"inherit",onClick:()=>{_("/groups")}}),(0,w.jsx)(g.A,{title:"Notifications",icon:(0,w.jsx)(h.A,{}),color:M?L:"inherit",value:G,onClick:()=>{T((0,v.kT)(!0)),T((0,A.Gd)())}})]}),null!==N&&void 0!==N&&null!==(t=N.avatar)&&void 0!==t&&t.url?(0,w.jsx)(g.A,{title:N.username,src:N.avatar.url,color:D?L:"inherit",sx:{display:{xs:"none",sm:"flex"}},onClick:z}):(0,w.jsx)(g.A,{title:N.username,icon:(0,w.jsx)(x.A,{}),color:D?L:"inherit",sx:{display:{xs:"none",sm:"flex"}},onClick:z})]}),P&&(0,w.jsx)(l.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(k,{})}),M&&(0,w.jsx)(l.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(C,{})}),U&&(0,w.jsx)(l.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(y,{})}),D&&(0,w.jsx)(l.Suspense,{fallback:(0,w.jsx)(a.A,{open:!0}),children:(0,w.jsx)(E,{})})]})},S=(0,l.memo)(_)},7025:(e,t,s)=>{s.d(t,{$H:()=>d,EI:()=>x,J8:()=>n,Jw:()=>c,OR:()=>g,_b:()=>p,bU:()=>a,hV:()=>f,nF:()=>u,nW:()=>h,o9:()=>m,qS:()=>i,tq:()=>l,u_:()=>r,v_:()=>o});const n="ALERT",r="REFETCH_CHATS",i="NEW_MESSAGE_ALERT",a="NEW_REQUEST",l="NEW_MESSAGE",o="START_TYPING",d="STOP_TYPING",c="CHAT_JOINED",u="ONLINE_USERS",h="ONLINE_USER_SET",x="ONLINE_USER_DELETE",m="GROUP_USER_TYPING",p="GROUP_USER_STOPPED_TYPING",g="REFETCH_PROFILE",f="REFETCH_GROUP_CHAT_MEMBERS"},7038:(e,t,s)=>{s.d(t,{A:()=>p});var n=s(2437),r=s(922),i=s(6990),a=s(8734),l=s(5043),o=s(3552),d=s(1702),c=s(8925),u=s(3768),h=s(6213),x=s(579);const m=e=>{let{isOpen:t,setIsOpen:s,dispatch:l,menuAnchor:m,openProfile:p}=e;return(0,x.jsx)(n.A,{open:t,onClose:()=>{m.current=null,s(!1)},anchorEl:m.current,anchorOrigin:{vertical:"right",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"center"},children:(0,x.jsx)("div",{style:{width:"10rem"},children:(0,x.jsxs)(r.A,{children:[(0,x.jsxs)(i.A,{onClick:p,children:[(0,x.jsx)(o.A,{}),(0,x.jsx)(a.A,{style:{marginLeft:"0.5rem"},children:"MyProfile"})]}),(0,x.jsxs)(i.A,{onClick:async()=>{try{const{data:e}=await h.A.get("".concat("https://chat-app-mern-07dn.onrender.com","/api/v1/user/logout"),{withCredentials:!0});l((0,c.TW)()),u.Ay.success(e.message)}catch(n){var e,t;u.Ay.error((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Something went wrong")}s(!1)},children:[(0,x.jsx)(d.A,{}),(0,x.jsx)(a.A,{style:{marginLeft:"0.5rem"},children:"Logout"})]})]})})})},p=(0,l.memo)(m)},5948:(e,t,s)=>{s.d(t,{Q7:()=>i,dF:()=>l,xB:()=>a});var n=s(5043),r=s(3768);const i=(e,t)=>{(0,n.useEffect)((()=>(Object.entries(t).forEach((t=>{let[s,n]=t;e.on(s,n)})),()=>{Object.entries(t).forEach((t=>{let[s,n]=t;e.off(s,n)}))})),[e,t])},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,n.useEffect)((()=>{e.forEach((e=>{let{isError:t,error:s,fallBack:n}=e;var i;t&&(n?n():r.Ay.error((null===s||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||"Something went wrong"))}))}),[e])},l=e=>{const[t,s]=(0,n.useState)(!1),[i,a]=(0,n.useState)(null),[l]=e();return[async function(e){s(!0);const t=r.Ay.loading(e||"Updating data...");try{for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];const e=await l(...i);var d,c;if(e.data)r.Ay.success(e.data.message||"Updated data Successfuly",{id:t}),a(e.data);else r.Ay.error((null===e||void 0===e||null===(d=e.error)||void 0===d||null===(c=d.data)||void 0===c?void 0:c.message)||"Something went wrong",{id:t})}catch(u){console.log(u),r.Ay.error("Something went wrong!",{id:t})}finally{s(!1)}},t,i]}},5079:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(5043),r=s(8911),i=s(5754),a=s(6446),l=s(9379),o=s(579);const d=e=>{let{avatar:t=[],max:s=4}=e;return(0,o.jsx)(r.A,{direction:"row",spacing:.5,children:(0,o.jsxs)(i.A,{max:s,sx:{position:"relative"},children:[(0,o.jsx)(a.A,{width:"5rem",height:"3rem"}),t&&(null===t||void 0===t?void 0:t.map(((e,t)=>{var s;return(0,o.jsx)(l.A,{src:null!==e&&void 0!==e&&e.avatar?null===e||void 0===e||null===(s=e.avatar)||void 0===s?void 0:s.url:e,alt:"Avatar ".concat(t),sx:{width:"3rem",height:"3rem",position:"absolute",left:{xs:"".concat(.5+t,"rem"),sm:"".concat(t+1,"rem")}}},100*Math.random())})))]})})},c=(0,n.memo)(d)},3302:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(5043),r=s(9367),i=s(579);const a=e=>{let{title:t="We-Chat",description:s="This is the Chat App"}=e;return(0,i.jsxs)(r.mg,{children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("meta",{name:"description",content:s})]})},l=(0,n.memo)(a)}}]);
//# sourceMappingURL=390.9de28716.chunk.js.map